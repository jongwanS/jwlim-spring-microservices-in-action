# 2. 스프링 클라우드와 함께 마이크로서비스 세계 탐험
- **시스템이 더 많이 분산될수록 실패할 곳은 더 많아진다.**
  - 마이크로서비스 아키텍처에 더 많은 실패 지점이 있다는 것을 의미한다.
## 2.1 스프링 클라우드란?
- 시장에서 검증된 수많은 오픈 소스 프로젝트를 모아 스프링 하위 프로젝트인 **스프링 클라우드**로 통합했다.
  - 프로젝트 설정 및 구성을 단순화

[그림 2-1] 마이크로서비스 개발 패턴
![img_1.png](images/ch02/img.png)        
출처 : 길벗 - 스프링 마이크로서비스 코딩 공작소 개정2판    

### 2.1.1 스프링 클라우드 컨피그
- **스프링 클라우드 컨피그**는 `애플리케이션 구성 데이터를 관리`한다.
- 애플리케이션구성 데이터(특히 환경별 구성 데이터)는 배포된 **마이크로서비스에서 완전히 분리**된다.
  - **모든 마이크로서비스가 동일한 구성을 보장**
- 스프링 클라우드 컨피그는 아래와 같은 **오픈 소스 프로젝트와 통합**된다.
  - `깃` : 스프링 클라우드 컨피그는 깃 백엔드 저장소와 통합
  - `콘술` : 오픈소스 서비스 디스커버리
  - `유레카` : 넷플릭스 오픈 소스 프로젝트

### 2.1.2 스프링 클라우드 서비스 디스커버리
- `스프링 클라우드 서비스 디스커버리`를 사용하면 **서버가 배포된 물리적 위치(IP 및 서버 이름)를 추상화**한다.
- 클라이언트는 물리적 위치가 아닌 `논리적 이름을 사용하여 서버의 비즈니스 로직을 호출`
> 콘술과 주키퍼가 강력하고 유연하지만 자바 개발자 커뮤니티는 여전히 유레카를 사용한다.

### 2.1.3 스프링 클라우드 로드 밸러서와 Resilience4j
- `스프링 클라우드 로드밸런서`
  - 서비스 디스커버리 에이전트와 통합(스프링 클라우드 로드밸런서가 특정 서비스의 인스턴스를 동적으로 찾아내고 연결)
  - 클라이언트 부하 분산 기능 제공
  - 서비스 디스커버리 에이전트가 잠시 중단되더라도 시스템이 완전히 멈추지 않고, 이미 알려진 인스턴스에 대한 호출을 유지할 수 있다
- `Resilience4j 라이브러리를 사용`
  - 회로 차단기, 재시도, 벌크헤드 등 **클라이언트 회복성 패턴을 구현**
### 2.1.4 스프링 클라우드 API 게이트웨이
- `API 게이트웨이`는 **서비스 라우팅 기능을 제공**한다.
  - 모든 호출이 `현관`을 통과하도록 하는 서비스 게이트웨이
  - `보안 인가`, `인증`, `콘텐츠 필터링`과 `라우팅 규칙` 등 **표준 서비스 정책을 시행**

### 2.1.5 스프링 클라우드 스트림
- `스프링 클라우드 스트림`은 **메시지 처리 기능을 마이크로서비스에 통합**하는 기술
  - RabbitMQ, 카프카와 같은 메시지 브로커를 서비스와 통합

### 2.1.6 스프링 클라우드 슬루스
- `스프링 클라우드 슬루스`는 **고유한 추적 식별자**를 애플리케이션에서 사용되는 HTTP 호출 및 메시지(카프카,엠큐) 채널에 통합한다.
  - 상관관계 ID나 트레이스 ID 를 사용하여 트랜잭션을 추적
  - 트레이스 ID: 요청 흐름 전체를 추적하는 식별자(상위 개념)
  - 상관관계 ID: 하위 요청 간의 상관관계를 추적하는 식별자(하위 개념)

### 2.1.7 스프링 클라우드 시큐리티
- `스프링 클라우드 시큐리티` **인증 및 인가(권한 부여) 프레임워크**
  - 서비스는 인증 시스템에서 발급된 토큰을 사용하여 서로 통신
  - HTTP 호출을 받는 각 서비스는 **전달받은 토큰을 확인**하여 사용자의 신원과 액세스 권한을 검증

## 2.2 스프링 클라우드 예제 소개
- 스프링 클라우드는 몇 가지 간단한 애너테이션과 구성 정보만으로 검증된 마이크로서비스 기능을 활용

## 2.3 클라우드 네이티브 마이크로서비스 구축 방법

### 2.3.1 코드베이스
- 각 마이크로서비스는 **단일 코드베이스**를 가진다.
  - `서버 프로비저닝 정보를 버전 관리`한다.
### 2.3.2 의존성
### 2.3.3 구성 정보
### 2.3.4 백엔드 서비스
### 2.3.5 빌드, 릴리스, 실행
### 2.3.6 프로세스
### 2.3.7 포트 바인딩
### 2.3.8 동시성
### 2.3.9 폐기 가능
### 2.3.10 개발 및 운영 환경 일치
### 2.3.11 로그
### 2.3.12 관리 프로세스


## 2.4 적절한 예제 도입
## 2.5 스프링 부트와 자바로 마이크로서비스 만들기
## 2.6 요약
